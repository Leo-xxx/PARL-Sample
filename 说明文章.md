## PaddlePaddleç‰ˆFlappy-Birdâ€”ä½¿ç”¨DQNç®—æ³•å®ç°æ¸¸æˆæ™ºèƒ½

åŸåˆ›ï¼š è®©ä½ æ›´æ‡‚AI [PaperWeekly](javascript:void(0);) *ä»Šå¤©*

![img](https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgm9RFr5icmiaj0bibJxUeIGdAFHNM4G6PJEiccw293RuVnOiadQ4zcdibdJa5FFfn0ZMgpbKib4AAKD8dm2w/640?tp=webp&wxfrom=5&wx_lazy=1)



åˆšåˆšä¸¾è¡Œçš„ WAVE SUMMIT 2019 æ·±åº¦å­¦ä¹ å¼€å‘è€…å³°ä¼šä¸Šï¼ŒPaddlePaddle å‘å¸ƒäº† PARL 1.1 ç‰ˆæœ¬ï¼Œè¿™ä¸€ç‰ˆæ–°å¢äº† IMPALAã€A3Cã€A2C ç­‰ä¸€ç³»åˆ—å¹¶è¡Œç®—æ³•ã€‚ä½œè€…é‡æ–°æµ‹è¯•äº†ä¸€éå†…ç½® exampleï¼Œå‘ç°å·ç§¯é€Ÿåº¦ä¹Ÿæ˜æ˜¾åŠ å¿«ï¼Œä» 1.0 ç‰ˆæœ¬çš„è®­ç»ƒä¸€å¸§éœ€å¤§çº¦ 1 ç§’ä¼˜åŒ–åˆ°äº† 0.15 ç§’ï¼ˆé…ç½®ï¼šwin8ï¼Œi5-6200Uï¼ŒGeForce-940Mï¼Œbatch-size=32ï¼‰ã€‚



å˜¿å˜¿ï¼Œè¶…çº§æœ¬å®ç°æ¸¸æˆæ™ºèƒ½çš„æ—¶ä»£ç»ˆäºæ¥ä¸´ï¼åºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬èµ¶ç´§è¯•è¯• PARL çš„å®˜æ–¹ DQN ç®—æ³•ï¼Œç©ä¸€ç© Flappy-Birdã€‚



**å…³äºä½œè€…ï¼š**æ›¹å¤©æ˜ï¼ˆkosoraï¼‰ï¼Œ2011 å¹´æ¯•ä¸šäºå¤©æ´¥ç§‘æŠ€å¤§å­¦ï¼Œ7 å¹´çš„ PHP+Java ç»éªŒã€‚ä¸ªäººç ”ç©¶æ–¹å‘â€”â€”èåˆ CLRS ä¸ DRL ä¸¤å¤§æŠ€æœ¯ä½“ç³»ï¼Œå¹¶è¡Œåˆ·é¢˜å’Œæ¨¡å‹è®­ç»ƒã€‚ä¸“æ³¨äºæ¸¸æˆæ™ºèƒ½ã€å°‘å„¿è¶£å‘³ç¼–ç¨‹ä¸¤å¤§é¢†åŸŸã€‚

 

# æ¨¡æ‹Ÿç¯å¢ƒ



ç›¸ä¿¡å¤§å®¶å¯¹äºè¿™ä¸ªæ¸¸æˆå¹¶ä¸é™Œç”Ÿï¼Œæˆ‘ä»¬éœ€è¦æ§åˆ¶ä¸€åªå°é¸Ÿå‘å‰é£è¡Œï¼Œåªæœ‰é£ç¿”ã€ä¸‹è½ä¸¤ç§æ“ä½œï¼Œå°é¸Ÿæ¯ç©¿è¿‡ä¸€æ ¹æŸ±å­ï¼Œæ€»åˆ†å°±ä¼šå¢åŠ ã€‚ç”±äºæŸ±å­æ˜¯é«˜ä½ä¸å¹³çš„ï¼Œæ‰€ä»¥éœ€è¦æƒ³å°½åŠæ³•èº²é¿å®ƒä»¬ã€‚ä¸€æ—¦ç¢°åˆ°äº†æŸ±å­ï¼Œæˆ–è€…ç¢°åˆ°äº†ä¸Šã€ä¸‹è¾¹ç¼˜ï¼Œéƒ½ä¼šå¯¼è‡´ game-overã€‚ä¸‹å›¾å±•ç¤ºäº†æœªç»è®­ç»ƒçš„å°ç¬¨é¸Ÿï¼Œå¯ä»¥çœ‹åˆ°ï¼Œä»–å¤„äº**äººå·¥æ™ºéšœ**çš„çŠ¶æ€ï¼Œç»å¸¸æ’æŸ±å­æˆ–è€…æ’è‰åœ°ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuzbW5BcSxA0VBYmtbVrQzZB4vxb5xCC2G99VhUn8ZLketoN30fLHx5w/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

**â–²** æœªç»è®­ç»ƒçš„å°ç¬¨é¸Ÿ



å…ˆç®€è¦åˆ†æä¸€ä¸‹ç¯å¢ƒ Environment çš„ä¸»è¦ä»£ç ã€‚



BirdEnv.py ç»§æ‰¿è‡ª gym.Envï¼Œå®ç°äº† initã€resetã€rewardã€render ç­‰æ ‡å‡†æ¥å£ã€‚init å‡½æ•°ï¼Œç”¨äºåŠ è½½å›¾ç‰‡ã€å£°éŸ³ç­‰å¤–éƒ¨æ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–å¾—åˆ†ã€å°é¸Ÿä½ç½®ã€ä¸Šä¸‹è¾¹ç¼˜ã€æ°´ç®¡ä½ç½®ç­‰ç¯å¢ƒä¿¡æ¯ï¼š



```
def __init__(self):
    if not hasattr(self,'IMAGES'):
        print('InitGame!')
        self.beforeInit()
    self.score = self.playerIndex = self.loopIter = 0
    self.playerx = int(SCREENWIDTH * 0.3)
    self.playery = int((SCREENHEIGHT - self.PLAYER_HEIGHT) / 2.25)
    self.baseShift = self.IMAGES['base'].get_width() - self.BACKGROUND_WIDTH
    newPipe1 = getRandomPipe(self.PIPE_HEIGHT)
    newPipe2 = getRandomPipe(self.PIPE_HEIGHT)
    #...other code
```



step å‡½æ•°ï¼Œæ‰§è¡Œä¸¤ä¸ªåŠ¨ä½œï¼Œ0 è¡¨ç¤ºä¸é‡‡å–è¡ŒåŠ¨ï¼ˆå°é¸Ÿä¼šè‡ªåŠ¨ä¸‹è½ï¼‰ï¼Œ1 è¡¨ç¤ºé£ç¿”ï¼›step å‡½æ•°æœ‰å››ä¸ªè¿”å›å€¼ï¼Œimage_data è¡¨ç¤ºå½“å‰çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯æ¸¸æˆç”»é¢ï¼Œreward è¡¨ç¤ºæœ¬æ¬¡ step çš„å³æ—¶å¥–åŠ±ï¼Œterminal è¡¨ç¤ºæ˜¯å¦æ˜¯å¸æ”¶çŠ¶æ€ï¼Œ{} è¡¨ç¤ºå…¶ä»–ä¿¡æ¯ï¼š



```
def step(self, input_action=0):
    pygame.event.pump()
    reward = 0.1
    terminal = False
    if input_action == 1:
        if self.playery > -2 * self.PLAYER_HEIGHT:
            self.playerVelY = self.playerFlapAcc
            self.playerFlapped = True
   #...other code

   image_data=self.render()
   return image_data, reward, terminal,{}
```



å¥–åŠ± rewardï¼›åˆå§‹å¥–åŠ±æ˜¯ +0.1ï¼Œè¡¨ç¤ºå°é¸Ÿå‘å‰é£è¡Œä¸€å°æ®µè·ç¦»ï¼›ç©¿è¿‡æŸ±å­ï¼Œå¥–åŠ± +1ï¼›æ’åˆ°æŸ±å­ï¼Œå¥–åŠ±ä¸º -1ï¼Œå¹¶ä¸”åˆ°è¾¾ terminal çŠ¶æ€ï¼š



```
#é£è¡Œä¸€æ®µè·ç¦»,å¥–åŠ±+0.1
reward = 0.1
#...other code

playerMidPos = self.playerx + self.PLAYER_WIDTH / 2
for pipe in self.upperPipes:
    pipeMidPos = pipe['x'] + self.PIPE_WIDTH / 2
    #ç©¿è¿‡ä¸€ä¸ªæŸ±å­å¥–åŠ±åŠ 1
    if pipeMidPos <= playerMidPos < pipeMidPos + 4:             
        self.score += 1
        reward = self.reward(1)
#...other code

if isCrash:
    #æ’åˆ°è¾¹ç¼˜æˆ–è€…æ’åˆ°æŸ±å­,ç»“æŸ,å¹¶ä¸”å¥–åŠ±ä¸º-1
    terminal = True
    reward = self.reward(-1)
```



reward å‡½æ•°ï¼Œè¿”å›å³æ—¶å¥–åŠ± rï¼š



```
def reward(self,r):
    return r
```



reset å‡½æ•°ï¼Œè°ƒç”¨ initï¼Œå¹¶æ‰§è¡Œä¸€æ¬¡é£ç¿”æ“ä½œï¼Œè¿”å› observation,reward,isOverï¼š



```
def reset(self,mode='train'):
    self.__init__()
    self.mode=mode
    action0 = 1
    observation, reward, isOver,_ = self.step(action0)
    return observation,reward,isOver
```



render å‡½æ•°ï¼Œæ¸²æŸ“æ¸¸æˆç•Œé¢ï¼Œå¹¶è¿”å›å½“å‰ç”»é¢ï¼š



```
def render(self):
    image_data = pygame.surfarray.array3d(pygame.display.get_surface())
    pygame.display.update()
    self.FPSCLOCK.tick(FPS)
    return image_data
```



è‡³æ­¤ï¼Œå¼ºåŒ–å­¦ä¹ æ‰€éœ€çš„çŠ¶æ€ã€åŠ¨ä½œã€å¥–åŠ±ç­‰åŠŸèƒ½å‡å®šä¹‰å®Œæ¯•ã€‚æ¥ä¸‹æ¥ç®€å•æ¨å¯¼ä¸€ä¸‹ DQN (Deep-Q-Network) ç®—æ³•çš„åŸç†ã€‚



# DQNçš„å‘å±•è¿‡ç¨‹



DQN çš„è¿›åŒ–å†å²å¯è°“æºè¿œæµé•¿ï¼Œä»æœ€å¼€å§‹ Bellman åœ¨ 1956 å¹´æå‡ºçš„åŠ¨æ€è§„åˆ’ï¼Œåˆ°åæ¥ Watkins åœ¨ 1989 å¹´æå‡ºçš„çš„ Q-learningï¼Œå†åˆ° DeepMind çš„ Nature-2015 ç¨³å®šç‰ˆï¼Œæœ€ååˆ° Dueling DQNã€Priority Replay Memoryã€Parameter Noise ç­‰ä¼˜åŒ–ç®—æ³•ï¼Œæ¨ªè·¨æ•´æ•´ä¸€ä¸ªç”²å­ï¼Œå‡èšäº†æ— æ•°ä¸“å®¶ã€æ•™æˆä»¬çš„å¿ƒè¡€ã€‚å¦‚ä»Šçš„æˆ‘ä»¬ç«™åœ¨å…ˆè´¤ä»¬çš„è‚©è†€ä¸Šï¼Œä»ä»¥ä¸‹è§’åº¦é€æ­¥åˆ†æï¼š



- è´å°”æ›¼ï¼ˆæœ€ä¼˜ï¼‰æ–¹ç¨‹ä¸ VQ æ ‘
- Q-learning
- å‚æ•°åŒ–é€¼è¿‘
- DQN ç®—æ³•æ¡†æ¶



# è´å°”æ›¼ (æœ€ä¼˜) æ–¹ç¨‹ä¸VQæ ‘



æˆ‘ä»¬ä»ç»å…¸çš„è¡¨æ ¼å‹å¼ºåŒ–å­¦ä¹ ï¼ˆTabular Reinforcement Learningï¼‰å¼€å§‹ï¼Œå›å¿†ä¸€ä¸‹é©¬å°”å¯å¤«å†³ç­–ï¼ˆMDPï¼‰è¿‡ç¨‹ï¼ŒMDP å¯ç”±äº”å…ƒç»„ (S,A,P,R,Î³) è¡¨ç¤ºï¼Œå…¶ä¸­ï¼š



- S çŠ¶æ€é›†åˆï¼Œç»´åº¦ä¸º 1Ã—|S| 
- A åŠ¨ä½œé›†åˆï¼Œç»´åº¦ä¸º 1Ã—|A| 
- P çŠ¶æ€è½¬ç§»æ¦‚ç‡çŸ©é˜µï¼Œç»å¸¸å†™æˆ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ï¼Œå…¶ç»´åº¦ä¸º |S|Ã—|A|Ã—|S| 
- R å›æŠ¥å‡½æ•°ï¼Œå¦‚æœä¾èµ–äºçŠ¶æ€å€¼å‡½æ•° Vï¼Œç»´åº¦ä¸º 1Ã—|S|ï¼Œå¦‚æœä¾èµ–äºçŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•° Qï¼Œåˆ™ç»´åº¦ä¸º |S|Ã—|A| 
- Î³ æŠ˜æ‰£å› å­ï¼Œç”¨æ¥è®¡ç®—å¸¦æŠ˜æ‰£çš„ç´¯è®¡å›æŠ¥ G(t)ï¼Œç»´åº¦ä¸º 1 



Sã€Aã€Rã€Î³ å‡ä¸éš¾ç†è§£ï¼Œå¯èƒ½éƒ¨åˆ†åŒå­¦å¯¹![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)æœ‰ç–‘é—®â€”â€”æ—¢ç„¶ S å’Œ A ç¡®å®šäº†ï¼Œä¸‹ä¸€ä¸ªçŠ¶æ€ S' ä¸æ˜¯ä¹Ÿç¡®å®šäº†å—ï¼Ÿä¸ºä»€ä¹ˆä¼šæœ‰æ¦‚ç‡è½¬ç§»çŸ©é˜µå‘¢ï¼Ÿ



å…¶å®æˆ‘åˆå­¦çš„æ—¶å€™ä¹Ÿæ›¾ç»è¢«è¿™ä¸ªé—®é¢˜å›°æ‰°è¿‡ï¼Œä¸å¦¨é€šè¿‡å¦‚ä¸‹ä¸¤ä¸ªä¾‹å­ä»¥ç¤ºåŒºåˆ«ï¼š



\1. ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)æ’ç­‰äº 1.0 çš„æƒ…å†µã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€æ¬¡æˆ‘ä»¬åœ¨ç­–ç•¥æ¢¯åº¦ç®—æ³•ä¸­æ‰€ä½¿ç”¨çš„è¿·å®«ï¼Œå‡è®¾æœºå™¨äººå¤„äºå·¦ä¸Šè§’ï¼Œè¿™æ—¶å€™ä½ å‘½ä»¤æœºå™¨äººå‘å³èµ°ï¼Œé‚£ä¹ˆä»–è½¬ç§»åˆ°çº¢æ¡†æ‰€ç¤ºä½ç½®çš„æ¦‚ç‡å°±æ˜¯ 1.0ï¼Œä¸ä¼šæœ‰ä»»ä½•å¼‚è®®ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QumzPdAuell8oOM8f2fWgZiariaPJ1JkIvltVdsr9DzESGFXHXtDTicoSTw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾1. è¿·å®«å¯»å®



\2. ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ä¸ç­‰äº 1.0 çš„æƒ…å†µã€‚å‡è®¾ç°åœ¨æˆ‘ä»¬ä¸‹ä¸€ä¸ªé£è¡Œæ£‹ï¼Œå¦‚å›¾ 2 æ‰€ç¤ºã€‚æœ‰ä¸¤ç§éª°å­ï¼Œç¬¬ä¸€ç§æ˜¯æ™®é€šçš„æ­£æ–¹ä½“éª°å­ï¼Œå¯ä»¥æŠ•å‡º 1~6ï¼Œç¬¬äºŒç§æ˜¯æ­£å››é¢ä½“çš„éª°å­ï¼Œå¯ä»¥æŠ•å‡º 1~4ã€‚ç°åœ¨é£æœºå¤„äºçº¢æ¡†æ‰€ç¤ºçš„ä½ç½®ï¼Œç°åœ¨æˆ‘ä»¬é€‰æ‹©**æŠ•æ·ç¬¬äºŒç§éª°å­**è¿™ä¸ªåŠ¨ä½œï¼Œç”±äºéª°å­æœ¬èº«å…·æœ‰å‡åŒ€éšæœºæ€§ï¼Œæ‰€ä»¥é£æœºè½¬ç§»åˆ°ç»ˆç‚¹çš„æ¦‚ç‡ä»…ä»…æ˜¯ 0.25ã€‚è¿™å°±è¯´æ˜ï¼Œåœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œç»™å®š Sã€A çš„æƒ…å†µä¸‹ï¼Œè½¬ç§»åˆ°å…·ä½“å“ªä¸€ä¸ª S' å…¶å®æ˜¯ä¸ç¡®å®šçš„ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QumqspAwOr8lCN9DazcmiaDpVXRC2RchQYLniaYUH4kBXEl6e0qrox1uIQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾2. é£è¡Œæ£‹



é™¤äº†ç»å…¸çš„äº”å…ƒç»„å¤–ï¼Œä¸ºäº†ç ”ç©¶é•¿æœŸå›æŠ¥ï¼Œè¿˜ç»å¸¸åŠ å…¥ä¸‰ä¸ªé‡è¦çš„å…ƒç´ ï¼Œåˆ†åˆ«æ˜¯ï¼š



- ç­–ç•¥ Ï€(aâˆ£s)ï¼Œç»´åº¦ä¸º |S|Ã—|A|

- çŠ¶æ€å€¼å‡½æ•°![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ï¼Œç»´åº¦ä¸º 1Ã—|S|ï¼Œè¡¨ç¤ºå½“æ™ºèƒ½ä½“é‡‡ç”¨ç­–ç•¥ Ï€ æ—¶ï¼Œç´¯ç§¯å›æŠ¥åœ¨çŠ¶æ€ s å¤„çš„æœŸæœ›å€¼ï¼š

  

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾3. çŠ¶æ€å€¼å‡½æ•°![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)



- çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuMTr3ZLaY42Ac7aZiaYYsfqHqVwy5QVKkPhicu0sg82icxMtKbKUYBOicfw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ï¼Œä¹Ÿå«çŠ¶æ€-åŠ¨ä½œå€¼å‡½æ•°ï¼Œç»´åº¦ä¸º |S|Ã—|A|ï¼Œè¡¨ç¤ºå½“æ™ºèƒ½ä½“é‡‡å–ç­–ç•¥ Ï€ æ—¶ï¼Œç´¯è®¡å›æŠ¥åœ¨çŠ¶æ€ s å¤„å¹¶æ‰§è¡ŒåŠ¨ä½œ a æ—¶çš„æœŸæœ›å€¼ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuUomR499ic295aKiahw4XKw0KOe0iaBOacoB6ib4ZRh573ozMia1G0UEOIqw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾4. çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuMTr3ZLaY42Ac7aZiaYYsfqHqVwy5QVKkPhicu0sg82icxMtKbKUYBOicfw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)



çŸ¥é“äº† Ï€ã€vã€q çš„å…·ä½“å«ä¹‰åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯ Vã€Q çš„é€’å½’å±•å¼€å¼ã€‚



å­¦è¿‡åŠ¨æ€è§„åˆ’çš„åŒå­¦éƒ½çŸ¥é“ï¼ŒåŠ¨æ€è§„åˆ’æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª bootstrapï¼ˆè‡ªä¸¾ï¼‰é—®é¢˜ï¼Œå®ƒåŒ…å«**æœ€ä¼˜å­ç»“æ„**ä¸**é‡å å­é—®é¢˜**ä¸¤ä¸ªæ€§è´¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•è§£å†³åŠ¨æ€è§„åˆ’ï¼š



- å°†æ€»é—®é¢˜åˆ’åˆ†ä¸º k ä¸ªå­é—®é¢˜ï¼Œé€’å½’æ±‚è§£è¿™äº›å­é—®é¢˜ï¼Œç„¶åå°†å­é—®é¢˜è¿›è¡Œåˆå¹¶ï¼Œå¾—åˆ°æ€»é—®é¢˜çš„æœ€ä¼˜è§£ï¼›å¯¹äºé‡å¤çš„å­é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»–ä»¬è¿›è¡Œç¼“å­˜ï¼ˆè®°å¿†æœç´¢ MemorySearchï¼Œè¯·å›å¿† f(n)=f(n-1)+f(n-2) è¿™ä¸ªé€’å½’ç¨‹åºï¼‰ï¼›

  

- è®¡ç®—æœ€å°çš„å­é—®é¢˜ï¼Œåˆå¹¶è¿™äº›å­é—®é¢˜äº§ç”Ÿä¸€ä¸ªæ›´å¤§çš„å­é—®é¢˜ï¼Œä¸æ–­çš„è‡ªåº•å‘ä¸Šè®¡ç®—ï¼Œéšç€å­é—®é¢˜çš„è§„æ¨¡è¶Šæ¥è¶Šå¤§ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°æœ€ç»ˆçš„æ€»é—®é¢˜çš„æœ€ä¼˜è§£ï¼ˆæ‰“è¡¨ DPï¼Œè¯·å›å¿†æ¨è¾‰ä¸‰è§’ä¸­çš„ dp[i-1,j-1]+dp[i-1,j]=dp[i,j]ï¼‰ã€‚



è¿™ä¸¤ç§åˆ‡é¢˜æŠ€å·§ï¼Œå¯¹äºæœ‰è¿‡ ACM æˆ–è€… LeetCode åˆ·é¢˜ç»éªŒçš„åŒå­¦ï¼Œå¯ä»¥è¯´æ˜¯è€æœ‹å‹äº†ï¼Œé‚£ä¹ˆèƒ½å¦æŠŠä»¥ä¸Šæ€æƒ³è¿ç§»åˆ°å¼ºåŒ–å­¦ä¹ å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼



åˆ†åˆ«è€ƒè™‘ vã€q çš„å±•å¼€å¼ï¼š



- å¤„åœ¨çŠ¶æ€ s æ—¶ï¼Œç”±äºæœ‰ç­–ç•¥ Ï€ çš„å­˜åœ¨ï¼Œæ•…å¯ä»¥æŠŠçŠ¶æ€å€¼å‡½æ•° v å±•å¼€æˆä»¥ä¸‹å½¢å¼ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRBibdf5HLYQfhy7sSvANX7DtuNWlxatUanCfDx1GtjTUicicIWnibkpSuQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾5. vå±•å¼€æˆq



è¿™ä¸ªå…¬å¼è¡¨ç¤ºï¼šåœ¨çŠ¶æ€ s å¤„çš„å€¼å‡½æ•°ï¼Œç­‰äºé‡‡å–ç­–ç•¥ Ï€ æ—¶ï¼Œæ‰€æœ‰çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°çš„æ€»å’Œã€‚



- å¤„åœ¨çŠ¶æ€ sã€å¹¶æ‰§è¡ŒåŠ¨ä½œ aï¼Œå¯ä»¥æŠŠçŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•° q å±•å¼€æˆä»¥ä¸‹å½¢å¼ï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾6. qå±•å¼€æˆv



è¿™ä¸ªå…¬å¼è¡¨ç¤ºï¼šåœ¨çŠ¶æ€ s é‡‡ç”¨åŠ¨ä½œ a çš„çŠ¶æ€è¡Œä¸ºå€¼å‡½æ•°ï¼Œç­‰äºå›æŠ¥åŠ ä¸Šååºå¯èƒ½äº§ç”Ÿçš„çš„çŠ¶æ€å€¼å‡½æ•°çš„æ€»å’Œã€‚



æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šv å¯ä»¥å±•å¼€æˆ qï¼ŒåŒæ—¶ q ä¹Ÿå¯ä»¥å±•å¼€æˆ vã€‚



æ‰€ä»¥å¯ä»¥ç”¨ä»¥ä¸‹ vã€q èŠ‚ç‚¹ç›¸éš”çš„æ ‘æ¥è¡¨ç¤ºä»¥ä¸Šä¸¤ä¸ªå…¬å¼ï¼Œè¿™é¢—æ ‘æ¯”çº¯ç²¹çš„å…¬å¼æ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘ä¹ æƒ¯ä¸ŠæŠŠå®ƒå«åš **V-Q æ ‘**ï¼Œå®ƒæ˜¾ç„¶æ˜¯ä¸€ä¸ªé€’å½’çš„ç»“æ„ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qu7hgTTTlTrnlZBjNouKGyicIBXwbCdFgKhKoR5CDKkGaHPlHqODeaAdA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾7. V-Qæ ‘



æ³¨æ„ç”»çº¢åœˆä¸­çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä½“ç°äº†**é‡å å­é—®é¢˜**ç‰¹æ€§ã€‚å¦‚ä½•ç†è§£è¿™ä¸ªæ€§è´¨å‘¢ï¼Ÿä¸å¦¨å›å¿†ä¸€ä¸‹ä¸Šæ–‡æåˆ°çš„é£è¡Œæ£‹ï¼Œå‡è®¾é£æœºå¤„åœ¨èµ·ç‚¹ä½ç½® 1ï¼Œé‚£ä¹ˆæ— è®ºæŠ•æ· 1 å·éª°å­è¿˜æ˜¯ 2 å·éª°å­ï¼Œéƒ½æ˜¯æœ‰æœºä¼šå¯ä»¥åˆ°è¾¾ä½ç½® 3 çš„ï¼Œè¿™å°±æ˜¯é‡å å­é—®é¢˜çš„ä¸€ä¸ªä¾‹å­ã€‚



æœ‰äº†è¿™æ£µé€’å½’æ ‘ä¹‹åï¼Œå°±ä¸éš¾æ¨å¯¼å‡º v å’Œ v'ï¼Œä»¥åŠ q å’Œ q' è‡ªèº«çš„é€’å½’å±•å¼€å¼ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qu1eyic24wNsBFpC3CkcZicFhjIysYoLnoJduGtVbGrmVv6JdAY9MFiaIWw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾8. çŠ¶æ€å€¼å‡½æ•°vè‡ªèº«çš„é€’å½’å±•å¼€å¼



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qu55LWO3CDwNz5WFN00S7vCflBYhKlucRaia0olfWrChRiap0p9JYlmk1Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾9. çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°qè‡ªèº«çš„é€’å½’å±•å¼€å¼



å…¶å®æ— è®ºæ˜¯ v è¿˜æ˜¯ qï¼Œéƒ½æ‹¥æœ‰æœ€ä¼˜å­ç»“æ„ç‰¹æ€§ã€‚ä¸å¦¨åˆ©ç”¨åè¯æ³•åŠ ä»¥è¯æ˜ï¼š



å‡è®¾è¦æ±‚æ€»é—®é¢˜ V(s) çš„æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆå®ƒåŒ…å«çš„æ¯ä¸ªå­é—®é¢˜ V(s') ä¹Ÿå¿…é¡»æ˜¯æœ€ä¼˜è§£ï¼›å¦åˆ™ï¼Œå¦‚æœæŸä¸ªå­é—®é¢˜ V(s') ä¸æ˜¯æœ€ä¼˜ï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰ä¸€ä¸ªæ›´ä¼˜çš„å­é—®é¢˜ V'(s') å­˜åœ¨ï¼Œä½¿å¾—æ€»é—®é¢˜ V'(s) æ¯”åŸæ¥çš„æ€»é—®é¢˜ V(s) æ›´ä¼˜ï¼Œä¸æˆ‘ä»¬çš„å‡è®¾ç›¸çŸ›ç›¾ï¼Œæ•…æœ€ä¼˜å­ç»“æ„æ€§è´¨å¾—è¯ï¼Œq(s) çš„æœ€ä¼˜å­ç»“æ„æ€§è´¨åŒç†ã€‚



è®¡ç®—å€¼å‡½æ•°çš„ç›®çš„æ˜¯ä¸ºäº†æ„å»ºå­¦ä¹ ç®—æ³•å¾—åˆ°æœ€ä¼˜ç­–ç•¥ï¼Œæ¯ä¸ªç­–ç•¥å¯¹åº”ç€ä¸€ä¸ªçŠ¶æ€å€¼å‡½æ•°ï¼Œæœ€ä¼˜ç­–ç•¥è‡ªç„¶ä¹Ÿå¯¹åº”ç€æœ€ä¼˜çŠ¶æ€å€¼å‡½æ•°ï¼Œæ•…è€Œå®šä¹‰å¦‚ä¸‹ä¸¤ä¸ªå‡½æ•°ï¼š



- æœ€ä¼˜çŠ¶æ€å€¼å‡½æ•°![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰ç­–ç•¥ä¸­æœ€å¤§çš„å€¼å‡½æ•°ï¼Œå³ï¼š

  

![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾10. æœ€ä¼˜çŠ¶æ€å€¼å‡½æ•°



- æœ€ä¼˜çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ï¼Œè¡¨ç¤ºåœ¨æ‰€æœ‰ç­–ç•¥ä¸­æœ€å¤§çš„çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°ï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾11. æœ€ä¼˜çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°



ç»“åˆä¸Šæ–‡çš„é€’å½’å±•å¼€å¼å’Œæœ€ä¼˜å­ç»“æ„æ€§è´¨ï¼Œå¯ä»¥å¾—åˆ° v ä¸ q çš„**è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹**ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuzMQEgyjDm804ZJx7WTgwWicwuuZnwKrC09u1UJLZpl0xRmK7B4YrOIA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾12. vçš„è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuH7BHhqhcxM7eXtgRHic3zceGlId8iaW4C3sIgO84pam7xiawSyibiaibaVZA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾13. qçš„è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹



é‡ç‚¹ç†è§£**ç¬¬äºŒä¸ªå…¬å¼**ï¼Œä¹Ÿå°±æ˜¯å…³äº q çš„è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹ï¼Œå®ƒæ˜¯ä»Šå¤©çš„ä¸»è§’ Q-learning ä»¥åŠ DQN çš„ç†è®ºåŸºç¡€ã€‚



æœ‰äº†è´å°”æ›¼æœ€ä¼˜æ–¹ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡çº¯ç²¹è´ªå¿ƒçš„ç­–ç•¥æ¥ç¡®å®š Ï€ï¼Œå³ï¼šä»…ä»…æŠŠæœ€ä¼˜åŠ¨ä½œçš„æ¦‚ç‡è®¾ç½®ä¸º 1ï¼Œå…¶ä»–æ‰€æœ‰éæœ€ä¼˜åŠ¨ä½œçš„æ¦‚ç‡éƒ½è®¾ç½®ä¸º 0ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼šå½“ç®—æ³•æ”¶æ•›çš„æ—¶å€™ï¼Œç­–ç•¥ Ï€(a|s) å¿…ç„¶æ˜¯ä¸€ä¸ª one-hot å‹çš„çŸ©é˜µã€‚ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾å¦‚ä¸‹ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QucnKC7OXg4cywibZcpPyybmO7xEkTacQUSeia6RFJ24ENxk96Du9Ln4Kw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾14. ç®—æ³•æ”¶æ•›æ—¶å€™çš„ç­–ç•¥Ï€



å¼ºåŒ–å­¦ä¹ ä¸­çš„åŠ¨æ€è§„åˆ’æ–¹æ³•å®è´¨ä¸Šæ˜¯ä¸€ç§ model-basedï¼ˆæ¨¡å‹å·²çŸ¥ï¼‰æ–¹æ³•ï¼Œå› ä¸º MDP äº”å…ƒç»„æ˜¯å·²çŸ¥çš„ï¼Œç‰¹åˆ«æ˜¯çŠ¶æ€è½¬ç§»æ¦‚ç‡çŸ©é˜µ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)æ˜¯å·²çŸ¥çš„ã€‚



ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„ç¯å¢ƒä¿¡æ¯å¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯ 100% å®Œå¤‡çš„ï¼Œæ•…è€Œå¯ä»¥å¯¹æ•´ä¸ªè§£ç©ºé—´æ ‘è¿›è¡Œå…¨å±€æœç´¢ï¼Œä¸‹å›¾å±•ç¤ºäº†åŠ¨æ€è§„åˆ’æ–¹æ³•çš„ç¤ºæ„å›¾ï¼Œåœ¨ç¡®å®šæ ¹èŠ‚ç‚¹çŠ¶æ€ S(t) çš„æœ€ä¼˜å€¼çš„æ—¶å€™ï¼Œå¿…é¡»éå†ä»–æ‰€æœ‰çš„ S(t+1) å­èŠ‚ç‚¹å¹¶é€‰å‡ºæœ€ä¼˜è§£ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuMFjZpKWj6QO7xic1h7MiaW48UOSlCHMvkj7GuvBcicXNEicJtnMNsYhjZA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾15. åŠ¨æ€è§„åˆ’æ–¹æ³•çš„è§£ç©ºé—´æœç´¢è¿‡ç¨‹



ä¸è¿‡ï¼Œå’Œä¼ ç»Ÿçš„**åˆ·é¢˜åŠ¨æ€è§„åˆ’**ç•¥æœ‰ä¸åŒï¼Œå¼ºåŒ–å­¦ä¹ å¾€å¾€æ˜¯åˆ©ç”¨å€¼è¿­ä»£ï¼ˆValue Iterationï¼‰ã€ç­–ç•¥è¿­ä»£ï¼ˆPolicy Iterationï¼‰ã€ç­–ç•¥æ”¹å–„ï¼ˆPolicy Improveï¼‰ç­‰æ–¹å¼ä½¿ vã€qã€Ï€ ç­‰å…ƒç´ è¾¾åˆ°æ”¶æ•›çŠ¶æ€ï¼Œå½“ç„¶ä¹Ÿæœ‰ç›´æ¥åˆ©ç”¨çŸ©é˜µæ±‚é€†è®¡ç®—è§£æè§£çš„æ–¹æ³•ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒç›¸å…³æ–‡çŒ®ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚



# Q-learning



ä¸Šæ–‡æåˆ°çš„åŠ¨æ€è§„åˆ’æ–¹æ³•æ˜¯ä¸€ç§ model-based æ–¹æ³•ï¼Œä»…ä»…é€‚ç”¨äº![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuRj5p85beiaMD7gIPL2LQpdmMOf3sZmibt1UGsTfl0sn6iaqU9B4164rKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)å·²çŸ¥çš„æƒ…å†µã€‚è‹¥çŠ¶æ€è½¬ç§»æ¦‚ç‡çŸ©é˜µæœªçŸ¥ï¼Œmodel-freeï¼ˆæ— æ¨¡å‹ï¼‰æ–¹æ³•å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¸Šä¸€æœŸçš„ MCPG ç®—æ³•å°±æ˜¯ä¸€ç§å…¸å‹çš„ model-free æ–¹æ³•ã€‚å®ƒæœç´¢è§£ç©ºé—´çš„æ–¹å¼æ›´åƒæ˜¯ DFSï¼ˆæ·±åº¦ä¼˜å…ˆæœç´¢ï¼‰ï¼Œè€Œä¸”ä¸€æ¡é“èµ°åˆ°é»‘ï¼Œæ²¡æœ‰æŒ‡é’ˆå›æº¯çš„æ“ä½œï¼Œä¸‹å›¾å±•ç¤ºäº†è’™ç‰¹å¡æ´›ç®—æ³•çš„æ±‚è§£ç¤ºæ„å›¾ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Quy4UH54usqSjyBNlHPvdrhh3N1p3SJjh8pIAGYCBhvsurbf5o3NE82g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾16. MCç³»åˆ—æ–¹æ³•çš„è§£ç©ºé—´æœç´¢è¿‡ç¨‹



è™½ç„¶æ¯æ¬¡åªèƒ½èµ°ä¸€æ¡åˆ†æ”¯ï¼Œä½†éšæœºæ•°å‘ç”Ÿå™¨ä¼šå¸®åŠ©ç®—æ³•éå†æ•´ä¸ªè§£ç©ºé—´ï¼Œå†é€šè¿‡å¤§é‡çš„è¿­ä»£ï¼Œæ‰€æœ‰èŠ‚ç‚¹ä¹Ÿä¼šæ”¶æ•›åˆ°æœ€ä¼˜è§£ã€‚



ä¸è¿‡ï¼ŒMC ç±»æ–¹æ³•æœ‰ä¸¤ä¸ªå°ç¼ºç‚¹ï¼š



\1. ä½¿ç”¨![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QulwjnKJiaxWMBdv6keSP6giacQibstTibcUib8pL6mjBHJtywFktUoiahEbpg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ä½œä¸ºè®­ç»ƒæ ‡ç­¾ï¼Œå…¶æœ¬èº«å°±æ˜¯å€¼å‡½æ•°å‡†ç¡®çš„æ— åä¼°è®¡ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿæ­£æ˜¯å®ƒçš„ç¼ºç‚¹ï¼Œå› ä¸º MC æ–¹æ³•ä¼šç»å†å¾ˆå¤šéšæœºçš„çŠ¶æ€å’ŒåŠ¨ä½œï¼Œä½¿å¾—æ¯æ¬¡å¾—åˆ°çš„ G(t) éšæœºæ€§å¾ˆå¤§ï¼Œå…·æœ‰å¾ˆé«˜çš„æ–¹å·®ã€‚



\2. ç”±äºé‡‡ç”¨çš„æ˜¯**ä¸€æ¡é“èµ°åˆ°é»‘**çš„æ–¹å¼ä»æ ¹èŠ‚ç‚¹éå†åˆ°å¶å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¿…é¡»è¦ç­‰åˆ° episode ç»“æŸæ‰èƒ½è¿›è¡Œè®­ç»ƒï¼Œè€Œä¸”æ¯è½® episode äº§ç”Ÿçš„æ•°æ®åªè®­ç»ƒä¸€æ¬¡ï¼Œæ¯è½® episode äº§ç”Ÿæ•°æ®çš„ batch-size è¿˜ä¸ä¸€å®šç›¸åŒï¼Œæ‰€ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒMC æ–¹æ³•çš„ loss å‡½æ•°ï¼ˆæˆ–è€… TD-Errorï¼‰çš„æ³¢åŠ¨å¹…åº¦è¾ƒå¤§ï¼Œè€Œæ•°æ®åˆ©ç”¨æ•ˆç‡ä¸é«˜ã€‚



é‚£ä¹ˆï¼Œèƒ½å¦è¾¹äº§ç”Ÿæ•°æ®è¾¹è®­ç»ƒå‘¢ï¼Ÿå¯ä»¥ï¼æ—¶åºå·®åˆ†ï¼ˆTemporal-Difference-Learningï¼Œç®€ç§° TDï¼‰ç®—æ³•åº”è¿è€Œç”Ÿäº†ã€‚



æ—¶åºå·®åˆ†å­¦ä¹ æ˜¯æ¨¡æ‹Ÿï¼ˆæˆ–è€…ç»å†ï¼‰ä¸€æ®µåºåˆ—ï¼Œæ¯è¡ŒåŠ¨ä¸€æ­¥ï¼ˆæˆ–è€…å‡ æ­¥ï¼‰å°±æ ¹æ®æ–°çŠ¶æ€çš„ä»·å€¼ä¼°è®¡å½“å‰æ‰§è¡Œçš„çŠ¶æ€ä»·å€¼ã€‚å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå°ç±»ï¼š



\1. TD(0) ç®—æ³•ï¼Œåªå‘åä¼°è®¡ä¸€ä¸ª stepã€‚å…¶å€¼å‡½æ•°æ›´æ–°å…¬å¼ä¸ºï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QugccUPRRMty3nBVcrkOjqJsGty8ycN5fUcqpJFjZjsic4cPcu6dFoaQg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾17. TD(0)ç®—æ³•çš„æ›´æ–°å…¬å¼



å…¶ä¸­ï¼ŒÎ± ä¸ºå­¦ä¹ ç‡ï¼Œ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuicTrUPzy2dFPvFvjBXaia0mZjmPtocZibPicsuNVPAIY3NP4uqIpLw1pjg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ç§°ä¸º TD ç›®æ ‡ï¼ŒMC æ–¹æ³•ä¸­çš„ G(t) ä¹Ÿå¯ä»¥å«åš TD ç›®æ ‡ï¼Œ![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuGVqPae6HdT0RxkPlED1BTNOLiclRstzrD502icsCYKkaHsmGDljEZgNg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)ç§°ä¸º TD-Errorï¼Œå½“æ¨¡å‹æ”¶æ•›æ—¶ï¼ŒTD-Error ä¼šæ— é™æ¥è¿‘äº 0ã€‚



\2. Sarsa(Î») ç®—æ³•ï¼Œå‘åä¼°è®¡ n æ­¥ï¼Œn ä¸ºæœ‰é™å€¼ï¼Œè¿˜æœ‰ä¸€ä¸ªè¡°å‡å› å­ Î»ã€‚å…¶å€¼å‡½æ•°çš„æ›´æ–°å…¬å¼ä¸ºï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾18. Sarsa(Î»)ç®—æ³•çš„æ›´æ–°å…¬å¼



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾19. ![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)çš„è®¡ç®—æ–¹æ³•



ä¸ MC æ–¹æ³•ç›¸æ¯”ï¼ŒTD æ–¹æ³•åªç”¨åˆ°äº†ä¸€æ­¥æˆ–è€…æœ‰é™æ­¥éšæœºçŠ¶æ€å’ŒåŠ¨ä½œï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªæœ‰åä¼°è®¡ã€‚ä¸è¿‡ï¼Œç”±äº TD ç›®æ ‡çš„éšæœºæ€§æ¯” MC æ–¹æ³•çš„ G(t) è¦å°ï¼Œæ‰€ä»¥æ–¹å·®ä¹Ÿæ¯” MC æ–¹æ³•å°çš„å¤šï¼Œå€¼å‡½æ•°çš„æ³¢åŠ¨å¹…åº¦è¾ƒå°ï¼Œè®­ç»ƒæ¯”è¾ƒç¨³å®šã€‚



çœ‹ä¸€ä¸‹ TD æ–¹æ³•çš„è§£ç©ºé—´æœç´¢ç¤ºæ„å›¾ï¼Œçº¢æ¡†è¡¨ç¤º TD(0)ï¼Œè“æ¡†è¡¨ç¤º Sarsa(Î»)ã€‚è™½ç„¶æ¯æ¬¡ä¼°è®¡éƒ½æœ‰ä¸€å®šçš„åå·®ï¼Œä½†éšç€ç®—æ³•çš„ä¸æ–­è¿­ä»£ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹ä¹Ÿä¼šæ”¶æ•›åˆ°æœ€ä¼˜è§£ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuKErLEszMu5thPqHiaVfbLDp1ZEDPicSog00y1BQX6Bb0qfEicT4gibemzw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾20. TDæ–¹æ³•çš„è§£ç©ºé—´æœç´¢è¿‡ç¨‹



æœ‰äº† TD çš„æ¡†æ¶ï¼Œæ—¢ç„¶æˆ‘ä»¬è¦æ±‚çŠ¶æ€å€¼å‡½æ•° vã€çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•° q çš„æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆæ˜¯å¦èƒ½ç›´æ¥é€‰æ‹©æœ€ä¼˜çš„ TD ç›®æ ‡ä½œä¸º Target å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè¿™ä¹Ÿæ˜¯ Q-Learning ç®—æ³•çš„åŸºæœ¬æ€æƒ³ï¼Œå…¶å…¬å¼å¦‚ä¸‹æ‰€ç¤ºï¼š



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuCpCx3mjgIU5IpZtydRBQhsZxBXajQHLg5XWXeRKdNDzHb7fZ9VJIGQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾21. Q-learningç®—æ³•çš„å­¦ä¹ å…¬å¼



å…¶ä¸­ï¼ŒåŠ¨ä½œ a ç”± Îµ-greedy ç­–ç•¥é€‰å‡ºï¼Œä»è€Œåœ¨çŠ¶æ€ s å¤„æ‰§è¡Œ a ä¹‹åäº§ç”Ÿäº†å¦ä¸€ä¸ªçŠ¶æ€ s'ï¼Œæ¥ä¸‹æ¥é€‰å‡ºçŠ¶æ€ s' å¤„æœ€å¤§çš„çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•° q(s',a')ï¼Œè¿™æ ·ï¼ŒTD ç›®æ ‡å°±å¯ä»¥ç¡®å®šä¸º R+Î³max[aâ€²]Q(sâ€²,aâ€²)ã€‚è¿™ç§æ€æƒ³å¾ˆåƒè´ªå¿ƒç®—æ³•ä¸­çš„**æ€»æ˜¯é€‰æ‹©åœ¨å½“å‰çœ‹æ¥æœ€ä¼˜çš„å†³ç­–**ï¼Œå®ƒä¸€å¼€å§‹å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œéšç€ç®—æ³•çš„ä¸æ–­è¿­ä»£ï¼Œæ•´ä¸ªè§£ç©ºé—´æ ‘ä¹Ÿä¼šæ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚



ä»¥ä¸‹æ˜¯ Q-learning ç®—æ³•çš„ä¼ªä»£ç ï¼Œå’Œ on-policy çš„ MC æ–¹æ³•å¯¹åº”ï¼Œå®ƒæ˜¯ä¸€ç§ off-policyï¼ˆå¼‚ç­–ç•¥ï¼‰æ–¹æ³•ï¼š



```
#define maxEpisode=65535 //å®šä¹‰æœ€å¤§è¿­ä»£è½®æ•°
#define maxStep=1024 //å®šä¹‰æ¯ä¸€è½®æœ€å¤šèµ°å¤šå°‘æ­¥
initialize Q_table[|S|,|A|] //åˆå§‹åŒ–QçŸ©é˜µ
for i in range(0,maxEpisode):
    s=env.reset()  //åˆå§‹åŒ–çŠ¶æ€s
    for j in range(0,maxStep):
        //ç”¨Îµ-greedyç­–ç•¥åœ¨sè¡Œé€‰ä¸€ä¸ªåŠ¨ä½œa
        choose action a using Îµ-greedy from Q_table[s] 
        s',R,terminal,_=env.step(a) //æ‰§è¡ŒåŠ¨ä½œa,å¾—åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€s',å¥–åŠ±Rï¼Œæ˜¯å¦ç»“æŸterminal
        max_s_prime_action=np.max(Q_table[s',:]) //é€‰s'å¯¹åº”çš„æœ€å¤§è¡Œä¸ºå€¼å‡½æ•°
        td=R+Î³*max_s_prime_action //è®¡ç®—TDç›®æ ‡
        Q_table[s,a]= Q_table[s,a]+Î±*(td-Q_table[s,a]) //å­¦ä¹ Q(s,a)çš„å€¼
        s=s' //æ›´æ–°sï¼Œæ³¨æ„ï¼Œå’Œsarsaç®—æ³•ä¸åŒï¼Œè¿™é‡Œçš„aä¸ç”¨æ›´æ–°
        if terminal:
            break
```



Q-learning æ˜¯ä¸€ç§ä¼˜ç§€çš„ç®—æ³•ï¼Œä¸ä»…ç®€å•ç›´è§‚ï¼Œè€Œä¸”å¹³å‡é€Ÿåº¦æ¯” MC å¿«ã€‚åœ¨ DRL æœªå‡ºç°ä¹‹å‰ï¼Œå®ƒåœ¨å¼ºåŒ–å­¦ä¹ ä¸­çš„åœ°ä½ï¼Œå·®ä¸å¤šå¯ä»¥åª²ç¾ SVM åœ¨æœºå™¨å­¦ä¹ ä¸­çš„åœ°ä½ã€‚



# å‚æ•°åŒ–é€¼è¿‘



æœ‰äº† Q-learning ç®—æ³•ï¼Œæ˜¯å¦å°±èƒ½ä¸€æ‹›åƒéå¤©ä¸‹é²œäº†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒå­˜åœ¨çš„é—®é¢˜ã€‚



ä¸Šæ–‡æ‰€æåˆ°çš„ï¼Œæ— è®ºæ˜¯ DPã€MC è¿˜æ˜¯ TDï¼Œéƒ½æ˜¯åŸºäºè¡¨æ ¼ï¼ˆtabularï¼‰çš„æ–¹æ³•ï¼Œå½“çŠ¶æ€ç©ºé—´æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œè®¡ç®—æœºå†…å­˜å®Œå…¨å¯ä»¥è£…ä¸‹,è¡¨æ ¼å¼å‹å¼ºåŒ–å­¦ä¹ æ˜¯å®Œå…¨é€‚ç”¨çš„ã€‚ä½†é‡åˆ°é«˜é˜¶é­”æ–¹ï¼ˆä¸‰é˜¶é­”æ–¹çš„æ€»å˜åŒ–æ•°æ˜¯![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ï¼‰ã€å›´æ£‹ï¼ˆ![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ï¼‰è¿™ç±»é—®é¢˜æ—¶ï¼ŒSã€Vã€Qã€P ç­‰è¡¨æ ¼å‡ä¼šå‡ºç°ç»´åº¦ç¾éš¾ï¼Œæ—©å°±è¶…å‡ºäº†è®¡ç®—æœºå†…å­˜ç”šè‡³ç¡¬ç›˜å®¹é‡ã€‚è¿™æ—¶å€™ï¼Œå‚æ•°åŒ–é€¼è¿‘æ–¹æ³•å°±æ´¾ä¸Šç”¨åœºäº†ã€‚



æ‰€è°“å‚æ•°åŒ–é€¼è¿‘ï¼Œæ˜¯æŒ‡å€¼å‡½æ•°å¯ä»¥ç”±ä¸€ç»„å‚æ•° Î¸ æ¥è¿‘ä¼¼ï¼Œå¦‚ Q-learning ä¸­çš„ Q(s,a) å¯ä»¥å†™æˆ Q(s,a|Î¸) çš„å½¢å¼ã€‚è¿™æ ·ï¼Œä¸ä½†é™ä½äº†å­˜å‚¨ç»´åº¦ï¼Œè¿˜ä¾¿äºåšä¸€äº›é¢å¤–çš„ç‰¹å¾å·¥ç¨‹ï¼Œè€Œä¸” Î¸ æ›´æ–°çš„åŒæ—¶ï¼ŒQ(s,a|Î¸) ä¼šè¿›è¡Œæ•´ä½“æ›´æ–°ï¼Œä¸ä»…é¿å…äº†è¿‡æ‹Ÿåˆæƒ…å†µï¼Œè¿˜ä½¿å¾—æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›æ›´å¼ºã€‚



æ—¢ç„¶æœ‰äº†å¯è®­ç»ƒå‚æ•°ï¼Œæˆ‘ä»¬å°±è¦ç ”ç©¶æŸå¤±å‡½æ•°äº†ï¼ŒQ-Learning çš„æŸå¤±å‡½æ•°æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ



å…ˆçœ‹ä¸€ä¸‹ Q-Learning çš„ä¼˜åŒ–ç›®æ ‡â€”â€”ä½¿å¾— TD-Error æœ€å°ï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾22. Q-Learningçš„ä¼˜åŒ–ç›®æ ‡



åŠ å…¥å‚æ•° Î¸ ä¹‹åï¼Œè‹¥å°† TD ç›®æ ‡![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)ä½œä¸ºæ ‡ç­¾ targetï¼Œå°† Q(s,a) ä½œä¸ºæ¨¡å‹çš„è¾“å‡º yï¼Œåˆ™é—®é¢˜è½¬åŒ–ä¸ºï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾23. å¸¦å‚æ•°çš„ä¼˜åŒ–ç›®æ ‡



è¿™æ˜¯æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„ç›‘ç£å­¦ä¹ ä¸­çš„å›å½’é—®é¢˜ï¼Œæ˜¾ç„¶ loss å‡½æ•°å°±æ˜¯ mseï¼Œæ•…è€Œå¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æœ€å°åŒ– lossï¼Œä»è€Œæ›´æ–°å‚æ•° Î¸ï¼š



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

**â–²** å›¾24. losså‡½æ•°çš„æ¢¯åº¦ä¸‹é™å…¬å¼



æ³¨æ„åˆ°ï¼ŒTD ç›®æ ‡æ˜¯æ ‡ç­¾ï¼Œæ‰€ä»¥ Q(s',a'|Î¸) ä¸­çš„ Î¸ æ˜¯ä¸èƒ½æ›´æ–°çš„ï¼Œè¿™ç§æ–¹æ³•å¹¶éå®Œå…¨çš„æ¢¯åº¦æ³•ï¼Œåªæœ‰éƒ¨åˆ†æ¢¯åº¦ï¼Œç§°ä¸ºåŠæ¢¯åº¦æ³•ï¼Œè¿™æ˜¯ NIPS-2013 çš„é›å½¢ã€‚



åæ¥ï¼ŒDeepMind åœ¨ Nature-2015 ç‰ˆæœ¬ä¸­å°† TD ç½‘ç»œå•ç‹¬åˆ†å¼€ï¼Œå…¶å‚æ•°ä¸º Î¸'ï¼Œå®ƒæœ¬èº«å¹¶ä¸å‚ä¸è®­ç»ƒï¼Œè€Œæ˜¯æ¯éš”å›ºå®šæ­¥æ•°å°†å€¼å‡½æ•°é€¼è¿‘çš„ç½‘ç»œå‚æ•° Î¸ æ‹·è´ç»™ Î¸'ï¼Œè¿™æ ·ä¿è¯äº† DQN çš„è®­ç»ƒæ›´åŠ ç¨³å®šï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuZnluGDPetTLHZrAoPu4Wfx9DJ0ELd3kib3hChCePG3T7F2zs9uYk27A/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾25. å«æœ‰ç›®æ ‡ç½‘ç»œå‚æ•°Î¸'çš„æ¢¯åº¦ä¸‹é™å…¬å¼

 

è‡³æ­¤ï¼ŒDQN çš„ Loss å‡½æ•°ã€æ¢¯åº¦ä¸‹é™å…¬å¼æ¨å¯¼å®Œæ¯•ã€‚



# DQNç®—æ³•æ¡†æ¶



æ¥ä¸‹æ¥ï¼Œè¿˜è¦è§£å†³ä¸¤ä¸ªé—®é¢˜â€”â€”æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿå¦‚ä½•é‡‡é›†ï¼Ÿ



é’ˆå¯¹ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ï¼ŒDeepMind å›¢é˜Ÿæå‡ºäº†æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„å…¨æ–°è®­ç»ƒæ–¹æ³•ï¼šç»éªŒå›æ”¾ï¼ˆexperience replayï¼‰ã€‚



åœ¨å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œæ™ºèƒ½ä½“å°†æ•°æ®å­˜å‚¨åˆ°ä¸€ä¸ª ReplayBuffer ä¸­ï¼ˆä»»ä½•ä¸€ç§é›†åˆï¼Œå¯ä»¥æ˜¯å“ˆå¸Œè¡¨ã€æ•°ç»„ã€é˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°æ®åº“ï¼‰ï¼Œç„¶ååˆ©ç”¨å‡åŒ€éšæœºé‡‡æ ·çš„æ–¹æ³•ä» ReplayBuffer ä¸­æŠ½å–æ•°æ®ï¼Œè¿™äº›æ•°æ®å°±å¯ä»¥è¿›è¡Œ Mini-Batch-SGDï¼Œè¿™æ ·å°±æ‰“ç ´äº†æ•°æ®ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä½¿å¾—æ•°æ®ä¹‹é—´å°½é‡ç¬¦åˆç‹¬ç«‹åŒåˆ†å¸ƒåŸåˆ™ã€‚



DQN çš„åŸºæœ¬ç½‘ç»œç»“æ„å¦‚ä¸‹ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuL52cZnKYnzjJYOMZFEqkOBwl3VNMqWNTOibbc1PjGgiaK8gQz7FBKU0w/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾26. DQNçš„åŸºæœ¬ç½‘ç»œç»“æ„



è¦ç‰¹åˆ«æ³¨æ„ï¼š



\1. ä¸å‚æ•° Î¸ åšçº¿æ€§è¿ç®— (wx+b) çš„ä»…ä»…æ˜¯è¾“å…¥çŠ¶æ€ sï¼Œè¿™ä¸€æ­¥æ²¡æœ‰åŠ¨ä½œ a çš„å‚ä¸ï¼›



\2. output_1 çš„ç»´åº¦ä¸º |A|ï¼Œè¡¨ç¤ºç¥ç»ç½‘ç»œ Q(s,Î¸) çš„è¾“å‡ºï¼›



\3. è¾“å…¥åŠ¨ä½œ a æ˜¯ one-hotï¼Œä¸ output_1 ä½œå“ˆè¾¾é©¬ç§¯åäº§ç”Ÿçš„ output_2 æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä½œä¸ºæŸå¤±å‡½æ•°ä¸­çš„ Q(s,a|Î¸)ï¼Œä¹Ÿå°±æ˜¯ yã€‚



ä»¥ä¸‹æ˜¯ DQN ç®—æ³•çš„ä¼ªä»£ç ï¼š



```
#Deep-Q-Network,Nature 2015 version

#å®šä¹‰ä¸ºä¸€ä¸ªåŒç«¯é˜Ÿåˆ—Dï¼Œä½œä¸ºç»éªŒå›æ”¾åŒºåŸŸï¼Œæœ€å¤§é•¿åº¦ä¸ºmax_size
Initialize replay_memory D as a deque,mas_size=50000

#åˆå§‹åŒ–çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°Qçš„ç¥ç»ç½‘ç»œï¼Œæƒå€¼éšæœº
Initialize action-value function Q(s,a|Î¸) as Neural Network with random-weights-initializer

#åˆå§‹åŒ–TDç›®æ ‡ç½‘ç»œï¼Œåˆå§‹æƒå€¼å’ŒÎ¸ç›¸ç­‰
Initialize target action-value function Q(s,a|Î¸) with weights Î¸'=Î¸

#è¿­ä»£max_episodeä¸ªè½®æ¬¡
for episode in range(0,max_episode=65535):

    #é‡ç½®ç¯å¢ƒenvï¼Œå¾—åˆ°åˆå§‹çŠ¶æ€s
    s=env.reset()

    #å¾ªç¯äº‹ä»¶çš„æ¯ä¸€æ­¥ï¼Œæœ€å¤šè¿­ä»£max_step_limitä¸ªstep
    for step in range(0,max_step_limit=1024):

        #é€šè¿‡Îµ-greedyçš„æ–¹å¼é€‰å‡ºä¸€ä¸ªåŠ¨ä½œaction
        With probability Îµ select a random action a or select a=argmax(Q(s,Î¸))

        #åœ¨envä¸­æ‰§è¡ŒåŠ¨ä½œaï¼Œå¾—åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€s'ï¼Œå¥–åŠ±R,æ˜¯å¦ç»ˆæ­¢terminal
        s',R,terminal,_=env.step(a)

        #å°†äº”å…ƒç»„(s,a,s',R,terminal)å‹è¿›é˜Ÿå°¾
        D.addLast(s,a,s',R,terminal)

        #å¦‚æœé˜Ÿåˆ—æ»¡ï¼Œå¼¹å‡ºé˜Ÿå¤´å…ƒç´ 
        if D.isFull():
            D.removeFirst()

        #æ›´æ–°çŠ¶æ€s
        s=s'

        #ä»é˜Ÿåˆ—ä¸­è¿›è¡Œéšæœºé‡‡æ ·
        batch_experience[s,a,s',R,terminal]=random_select(D,batch_size=32)

        #è®¡ç®—TDç›®æ ‡
        target = R + Î³*(1- terminal) * np.max(Q(s',Î¸'))

        #å¯¹losså‡½æ•°æ‰§è¡ŒGradient-decentï¼Œè®­ç»ƒå‚æ•°Î¸
        Î¸=Î¸+Î±*(target-Q(s,a|Î¸))â–½Q(s,a|Î¸)

        #æ¯éš”Cæ­¥ï¼ŒåŒæ­¥Î¸ä¸Î¸'çš„æƒå€¼
        Every C steps set Î¸'=Î¸

        #æ˜¯å¦ç»“æŸ
        if terminalï¼š
           break 
```



æˆ‘ä»¬ç©çš„æ¸¸æˆ Flappy-Birdï¼Œå®ƒçš„è¾“å…¥æ˜¯ä¸€å¸§ä¸€å¸§çš„å›¾ç‰‡ï¼Œæ‰€ä»¥ï¼Œç»å…¸çš„ Atari-CNN æ¨¡å‹å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qur6icYo0Mlk1JBpCic6iaG4TeXBndo3BEHic9j3qZ5Xeh38KUK6tWmiafOeQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾27. Atariæ¸¸æˆçš„CNNç½‘ç»œç»“æ„



ç½‘ç»œçš„è¾“å…¥æ˜¯è¢«å¤„ç†æˆç°åº¦å›¾çš„æœ€è¿‘ 4 å¸§ 84*84 å›¾åƒï¼ˆ4 æ˜¯ç»éªŒå€¼ï¼‰ï¼Œç»è¿‡è‹¥å¹² CNN å’Œ FullyConnect åï¼Œè¾“å‡ºå„ä¸ªåŠ¨ä½œæ‰€å¯¹åº”çš„çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•° Qã€‚ä»¥ä¸‹æ˜¯æ¯ä¸€å±‚çš„å…·ä½“å‚æ•°ï¼Œç”±äº atari æ¸¸æˆæœ€å¤šæœ‰ 18 ä¸ªåŠ¨ä½œï¼Œæ‰€ä»¥æœ€åä¸€å±‚çš„ç»´åº¦æ˜¯ 18ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QugO94C3Hsz1X57sY3Tnqc9dI1noUOurxLF4VnicOAqyV4twYRpB6pRMw/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾28. ç¥ç»ç½‘ç»œçš„å…·ä½“å‚æ•°



è‡³æ­¤ï¼Œç†è®ºéƒ¨åˆ†æ¨å¯¼å®Œæ¯•ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹ PARL ä¸­çš„ DQN éƒ¨åˆ†çš„æºç ï¼Œå¹¶å®ç° Flappy-Bird çš„æ¸¸æˆæ™ºèƒ½ã€‚



# ä»£ç å®ç°



ä¾æ¬¡åˆ†æ envã€modelã€algorithmã€agentã€replay_memoryã€train ç­‰æ¨¡å—ã€‚



\1. BirdEnv.pyï¼Œç¯å¢ƒï¼›ä¸Šæ–‡å·²ç»åˆ†æè¿‡äº†ã€‚



\2. BirdModel.pyï¼Œç¥ç»ç½‘ç»œæ¨¡å‹ï¼›ä½¿ç”¨ä¸‰å±‚ CNN+ä¸¤å±‚ FCï¼ŒCNN çš„ padding æ–¹å¼éƒ½æ˜¯ validï¼Œæœ€åè¾“å‡ºçŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•° Qï¼Œç»´åº¦ä¸º |A|ã€‚æ³¨æ„è¾“å…¥å›¾ç‰‡å½’ä¸€åŒ–ï¼Œå¹¶æŒ‰ç…§å®˜æ–¹æ¨¡æ¿å¡«å…¥ä»£ç ï¼š



```
class BirdModel(Model):
    def __init__(self, act_dim):
        self.act_dim = act_dim
        #paddingæ–¹å¼ä¸ºvalid
        p_valid=0
        self.conv1 = layers.conv2d(
            num_filters=32, filter_size=8, stride=4, padding=p_valid, act='relu')
        self.conv2 = layers.conv2d(
            num_filters=64, filter_size=4, stride=2, padding=p_valid, act='relu')
        self.conv3 = layers.conv2d(
            num_filters=64, filter_size=3, stride=1, padding=p_valid, act='relu')
        self.fc0=layers.fc(size=512)
        self.fc1 = layers.fc(size=act_dim)

    def value(self, obs):
        #è¾“å…¥å½’ä¸€åŒ–
        obs = obs / 255.0
        out = self.conv1(obs)
        out = self.conv2(out)
        out = self.conv3(out)
        out = layers.flatten(out, axis=1)
        out = self.fc0(out)
        out = self.fc1(out)
        return out
```



\3. dqn.pyï¼Œç®—æ³•å±‚ï¼›**å®˜æ–¹ä»“åº“å·²ç»æä¾›å¥½äº†ï¼Œæˆ‘ä»¬æ— éœ€è‡ªå·±å†å†™ï¼Œç›´æ¥å¤ç”¨ç®—æ³•åº“ï¼ˆparl.algorithmsï¼‰é‡Œè¾¹çš„ DQN ç®—æ³•å³å¯ã€‚** 



ç®€å•åˆ†æä¸€ä¸‹ DQN çš„æºç å®ç°ã€‚



define_learn å‡½æ•°ï¼Œç”¨äºç¥ç»ç½‘ç»œçš„å­¦ä¹ ã€‚æ¥æ”¶ [çŠ¶æ€ obs, åŠ¨ä½œ action, å³æ—¶å¥–åŠ± reward, ä¸‹ä¸€ä¸ªçŠ¶æ€ next_obs, æ˜¯å¦ç»ˆæ­¢ terminal] è¿™æ ·ä¸€ä¸ªäº”å…ƒç»„ï¼Œä»£ç å®ç°å¦‚ä¸‹ï¼š



```
#æ ¹æ®obsä»¥åŠå‚æ•°Î¸è®¡ç®—çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°pred_valueï¼Œå¯¹åº”ä¼ªä»£ç ä¸­çš„Q(s,Î¸)
pred_value = self.model.value(obs)

#æ ¹æ®next_obsä»¥åŠå‚æ•°Î¸'è®¡ç®—ç›®æ ‡ç½‘ç»œçš„çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°next_pred_valueï¼Œå¯¹åº”ä¼ªä»£ç ä¸­çš„Q(s',Î¸')
next_pred_value = self.target_model.value(next_obs)

#é€‰å‡ºnext_pred_valueçš„æœ€å¤§å€¼best_vï¼Œå¯¹åº”ä¼ªä»£ç ä¸­çš„np.max(Q(s',Î¸'))ï¼›æ³¨æ„Î¸'ä¸å‚ä¸è®­ç»ƒï¼Œæ‰€ä»¥è¦stop_gradient
best_v = layers.reduce_max(next_pred_value, dim=1)
best_v.stop_gradient = True

#è®¡ç®—TDç›®æ ‡
target = reward + (1.0 - layers.cast(terminal, dtype='float32')) * self.gamma * best_v

#è¾“å…¥çš„åŠ¨ä½œactionä¸pred_valueä½œå“ˆè¾¾ç›ç§¯ï¼Œé€‰å‡ºè¦è¯„ä¼°çš„çŠ¶æ€-è¡Œä¸ºå€¼å‡½æ•°pred_action_valueï¼Œå¯¹åº”ä¼ªä»£ç ä¸­çš„ Q(s,a|Î¸)
action_onehot = layers.one_hot(action, self.action_dim)
action_onehot = layers.cast(action_onehot, dtype='float32')
pred_action_value = layers.reduce_sum(layers.elementwise_mul(action_onehot, pred_value), dim=1)

#mseä»¥åŠæ¢¯åº¦ä¸‹é™ï¼Œå¯¹åº”ä¼ªä»£ç ä¸­çš„Î¸=Î¸+Î±*(target-Q(s,a|Î¸))â–½Q(s,a|Î¸)
cost = layers.square_error_cost(pred_action_value, target)
cost = layers.reduce_mean(cost)
optimizer = fluid.optimizer.Adam(self.lr, epsilon=1e-3)
optimizer.minimize(cost)
```



sync_target å‡½æ•°ç”¨äºåŒæ­¥ç½‘ç»œå‚æ•°ï¼š



```
def sync_target(self, gpu_id):
    """ sync parameters of self.target_model with self.model
    """
    self.model.sync_params_to(self.target_model, gpu_id=gpu_id)
```



\4. BirdAgent.pyï¼Œæ™ºèƒ½ä½“ã€‚å…¶ä¸­ï¼Œbuild_program å‡½æ•°å°è£…äº† algorithm ä¸­çš„ define_predict å’Œ define_learnï¼Œsample å‡½æ•°ä»¥ Îµ-greedy ç­–ç•¥é€‰æ‹©åŠ¨ä½œï¼Œpredict å‡½æ•°ä»¥ 100% è´ªå¿ƒçš„ç­–ç•¥é€‰æ‹© argmax åŠ¨ä½œï¼Œlearn å‡½æ•°æ¥æ”¶äº”å…ƒç»„ (obs, act, reward, next_obs, terminal) å®Œæˆå­¦ä¹ åŠŸèƒ½ï¼Œè¿™äº›å‡½æ•°å’Œ Policy-Gradient çš„å†™æ³•ç±»ä¼¼ã€‚



é™¤äº†è¿™äº›å¸¸ç”¨åŠŸèƒ½ä¹‹å¤–ï¼Œç”±äºæ¸¸æˆçš„è®­ç»ƒæ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥é™„åŠ äº†ä¸¤ä¸ªå‡½æ•°ï¼Œsave_params ç”¨äºä¿å­˜æ¨¡å‹ï¼Œload_params ç”¨äºåŠ è½½æ¨¡å‹ï¼š



```
#ä¿å­˜æ¨¡å‹
def save_params(self, learnDir,predictDir):
    fluid.io.save_params(
        executor=self.fluid_executor,
        dirname=learnDir,
        main_program=self.learn_programs[0])   
    fluid.io.save_params(
        executor=self.fluid_executor,
        dirname=predictDir,
        main_program=self.predict_programs[0])     

#åŠ è½½æ¨¡å‹
def load_params(self, learnDir,predictDir): 
    fluid.io.load_params(
        executor=self.fluid_executor,
        dirname=learnDir,
        main_program=self.learn_programs[0])  
    fluid.io.load_params(
        executor=self.fluid_executor,
        dirname=predictDir,
        main_program=self.predict_programs[0]) 
```



å¦å¤–ï¼Œè¿˜æœ‰å››ä¸ªè¶…å‚æ•°ï¼Œå¯ä»¥è¿›è¡Œå¾®è°ƒï¼š



```
#æ¯è®­ç»ƒå¤šå°‘æ­¥æ›´æ–°targetç½‘ç»œ,è¶…å‚æ•°å¯è°ƒ
self.update_target_steps = 5000

#åˆå§‹æ¢ç´¢æ¦‚ç‡Îµ,è¶…å‚æ•°å¯å¾®è°ƒ
self.exploration = 0.8

#æ¯æ­¥æ¢ç´¢çš„è¡°å‡ç¨‹åº¦,è¶…å‚æ•°å¯å¾®è°ƒ
self.exploration_dacay=1e-6

#æœ€å°æ¢ç´¢æ¦‚ç‡,è¶…å‚æ•°å¯å¾®è°ƒ
self.min_exploration=0.05
```



\5. replay_memory.pyï¼Œç»éªŒå›æ”¾å•å…ƒã€‚åŒç«¯é˜Ÿåˆ— _context æ˜¯ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œç”¨æ¥è®°å½•æœ€è¿‘ 3 å¸§ï¼ˆå†åŠ ä¸Šæ–°äº§ç”Ÿçš„ 1 å¸§å°±æ˜¯ 4 å¸§ï¼‰ï¼›stateã€actionã€reward ç­‰ç”¨ numpy æ•°ç»„å­˜å‚¨ï¼Œå› ä¸º numpy çš„åŠŸèƒ½æ¯”åŒç«¯é˜Ÿåˆ—æ›´ä¸°å¯Œï¼Œmax_size è¡¨ç¤º replay_memory çš„æœ€å¤§å®¹é‡ï¼š



```
self.state = np.zeros((self.max_size, ) + state_shape, dtype='int32')
self.action = np.zeros((self.max_size, ), dtype='int32')
self.reward = np.zeros((self.max_size, ), dtype='float32')
self.isOver = np.zeros((self.max_size, ), dtype='bool')
#_contextæ˜¯ä¸€ä¸ªæ»‘åŠ¨çª—å£,é•¿åº¦æ°¸è¿œä¿æŒ3
self._context = deque(maxlen=context_len - 1)
```



å…¶ä»–çš„ appendã€recent_stateã€sample_batch ç­‰å‡½æ•°å¹¶ä¸éš¾ç†è§£ï¼Œéƒ½æ˜¯åŸºäº numpy æ•°ç»„çš„è¿›ä¸€æ­¥å°è£…ï¼Œç•¥è¿‡ä¸€éå³å¯çœ‹æ‡‚ã€‚



\6. Train_Test_Working_Flow.pyï¼Œè®­ç»ƒä¸æµ‹è¯•ï¼Œè®©ç¯å¢ƒ evn å’Œæ™ºèƒ½ä½“ agent è¿›è¡Œäº¤äº’ã€‚æœ€é‡è¦çš„å°±æ˜¯ run_train_episode å‡½æ•°ï¼Œä½“ç°äº† DQN çš„ä¸»è¦é€»è¾‘ï¼Œé‡ç‚¹åˆ†ææ³¨é‡Šéƒ¨åˆ†ä¸ DQN ä¼ªä»£ç çš„å¯¹åº”å…³ç³»ï¼Œå…¶ä»–éƒ½æ˜¯ç¼–ç¨‹ç»†èŠ‚ï¼š



```
 #è®­ç»ƒä¸€ä¸ªepisode
def run_train_episode(env, agent, rpm):
    global trainEpisode
    global meanReward
    total_reward = 0
    all_cost = []
    #é‡ç½®ç¯å¢ƒ
    state,_, __ = env.reset()
    step = 0
    #å¾ªç¯æ¯ä¸€æ­¥
    while True:
        context = rpm.recent_state()
        context.append(resizeBirdrToAtari(state))
        context = np.stack(context, axis=0)
        #ç”¨Îµ-greedyçš„æ–¹å¼é€‰ä¸€ä¸ªåŠ¨ä½œ
        action = agent.sample(context)
        #æ‰§è¡ŒåŠ¨ä½œ
        next_state, reward, isOver,_ = env.step(action)
        step += 1
        #å­˜å…¥replay_buffer
        rpm.append(Experience(resizeBirdrToAtari(state), action, reward, isOver))
        if rpm.size() > MEMORY_WARMUP_SIZE:
            if step % UPDATE_FREQ == 0:
                #ä»replay_bufferä¸­éšæœºé‡‡æ ·
                batch_all_state, batch_action, batch_reward, batch_isOver = rpm.sample_batch(batchSize)
                batch_state = batch_all_state[:, :CONTEXT_LEN, :, :]
                batch_next_state = batch_all_state[:, 1:, :, :]
                #æ‰§è¡ŒSGD,è®­ç»ƒå‚æ•°Î¸
                cost=agent.learn(batch_state,batch_action, batch_reward,batch_next_state, batch_isOver)
                all_cost.append(float(cost))
        total_reward += reward
        state = next_state
        if isOver or step>=MAX_Step_Limit:
            break
    if all_cost:
        trainEpisode+=1
        #ä»¥æ»‘åŠ¨å¹³å‡çš„æ–¹å¼æ‰“å°å¹³å‡å¥–åŠ±
        meanReward=meanReward+(total_reward-meanReward)/trainEpisode
        print('\n trainEpisode:{},total_reward:{:.2f}, meanReward:{:.2f} mean_cost:{:.3f}'\
              .format(trainEpisode,total_reward, meanReward,np.mean(all_cost)))
    return total_reward, step
```



é™¤äº†ä¸»è¦é€»è¾‘å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µï¼Œé˜²æ­¢è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç° trickï¼š



```
#å……æ»¡replay-memory,ä½¿å…¶è¾¾åˆ°warm-up-sizeæ‰å¼€å§‹è®­ç»ƒ
MEMORY_WARMUP_SIZE = MEMORY_SIZE//20

##ä¸€è½®episodeæœ€å¤šæ‰§è¡Œå¤šå°‘æ¬¡stepï¼Œä¸ç„¶å°é¸Ÿä¼šæ— é™åˆ¶çš„é£ä¸‹å»,ç›¸å½“äºgym.envä¸­çš„_max_episode_stepså±æ€§
MAX_Step_Limit=int(1<<12)

#ç”¨ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—è®°å½•æœ€è¿‘16æ¬¡episodeçš„å¹³å‡å¥–åŠ±
avgQueue=deque(maxlen=16)
```



å¦å¤–ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›è¶…å‚æ•°ï¼Œæ¯”å¦‚å­¦ä¹ ç‡ LEARNING_RATEã€è¡°å‡å› å­ GAMMAã€è®°å½•æ—¥å¿—çš„é¢‘ç‡ log_freq ç­‰ç­‰ï¼Œéƒ½å¯ä»¥è¿›è¡Œå¾®è°ƒï¼š



```
#è¡°å‡å› å­
GAMMA = 0.99

#å­¦ä¹ ç‡
LEARNING_RATE = 1e-3 * 0.5

#è®°å½•æ—¥å¿—çš„é¢‘ç‡
log_freq=10
```



main å‡½æ•°åœ¨è¿™é‡Œï¼Œè¾“å…¥ train è®­ç»ƒç½‘ç»œï¼Œè¾“å…¥ test è¿›è¡Œæµ‹è¯•ï¼š



```
if __name__ == '__main__':
    print("train or test ?")
    mode=input()
    print(mode)
    if mode=='train':
        train()
    elif mode=='test':
        test()
    else:
        print('Invalid input!')
```



è¿™æ˜¯æ¨¡å‹åœ¨æˆ‘æœ¬æœºè®­ç»ƒçš„è¾“å‡ºæ—¥å¿—ï¼Œå¤§æ¦‚ 3300 ä¸ª episodeã€50 ä¸‡æ­¥ä¹‹åï¼Œæ¨¡å‹å°±æ”¶æ•›äº†ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QumjgZ5WbFGAc6VRCoNEunNgYGPib3vhc4fLgmVkfwJulLtFY467jibtAg/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾29. æ¨¡å‹è®­ç»ƒçš„è¾“å‡ºæ—¥å¿—



å¹³å‡å¥–åŠ±ï¼š



![img](https://mmbiz.qpic.cn/mmbiz_jpg/VBcD02jFhgmGbPvclMzqXl0RViaGHb9QuMpfCrtnH9DQtJ7d1YbIccXowHHtRibMdR149GAicmNLpfOYiciafao64fQ/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

**â–²** å›¾30. æœ€è¿‘16æ¬¡å¹³å‡å¥–åŠ±å˜åŒ–æ›²çº¿



å„ä½åŒå­¦å¯ä»¥è¯•ç€è°ƒèŠ‚è¶…å‚æ•°ï¼Œæˆ–è€…ä¿®æ”¹ç½‘ç»œæ¨¡å‹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é‡åˆ°ä¸€äº›å‘ï¼Ÿå“ªäº›å› ç´ ä¼šå½±å“è®­ç»ƒæ•ˆç‡ï¼Ÿå¦‚ä½•æå‡æ”¶æ•›é€Ÿåº¦ï¼Ÿ



æ¥ä¸‹æ¥å°±æ˜¯è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼Œå½“åˆæ‡µæ‡‚çš„å°ç¬¨é¸Ÿï¼Œå¦‚ä»Šå·²**ä¿®ç‚¼æˆç²¾**äº†ï¼



![img](https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qu5hbPscgmPug70FWScnsuZ5gQ0nfsZ0KxAcEOsEibETEwfmR3JDcIiafw/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)



![img](https://mmbiz.qpic.cn/mmbiz_gif/VBcD02jFhgmGbPvclMzqXl0RViaGHb9Qu8ic0HzfeEJHgaiaSsIyEiadeckRyxXD46EyAz6NVZtp1HwKhkfpP0J05Q/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1)

**â–²** è®­ç»ƒå®Œçš„FlappyBird



**è§‚çœ‹ 4 åˆ†é’Ÿå®Œæ•´ç‰ˆï¼š**



https://www.bilibili.com/video/av49282860/



**Githubæºç ****ï¼š**



https://github.com/kosoraYintai/PARL-Sample/tree/master/flappy_bird



# å‚è€ƒæ–‡çŒ®



[1] Bellman, R.E. & Dreyfus, S.E. (1962). Applied dynamic programming. RAND Corporation. 

[2] Sutton, R.S. (1988). Learning to predict by the methods of temporal difference.Machine Learning, 3, pp. 9â€“44.

[3] V. Mnih, K. Kavukcuoglu, D. Silver, A. A. Rusu, et al., "Human-level control through deep reinforcement learning," Nature, vol. 518(7540), pp. 529-533, 2015.

[4] https://leetcode.com/problems/climbing-stairs/ 

[5] https://leetcode.com/problems/pascals-triangle-ii/ 

[6] https://github.com/yenchenlin/DeepLearningFlappyBird 

[7] https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow



![img](https://mmbiz.qpic.cn/mmbiz_png/VBcD02jFhgmPEF4lW0pL5weJia5y4xhJbog2pIZZ3ZCgVUDynvus6rCzNKGAAAI6R8jaXTpYPISCMicpFegVdG0g/640?tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)





**ç‚¹å‡»ä»¥ä¸‹æ ‡é¢˜æŸ¥çœ‹æ›´å¤šå¾€æœŸå†…å®¹ï¼š** 



- [ç›®æ ‡æ£€æµ‹å°tricksä¹‹æ ·æœ¬ä¸å‡è¡¡å¤„ç†](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247496155&idx=1&sn=b720e982a8e99a5db93a48c59ecad8d5&chksm=96ea2e5ba19da74dff62f9e57043423e9dd4ac4109933aad530b96fed279d80e5f7ad516eb50&scene=21#wechat_redirect)

- [å›¾ç¥ç»ç½‘ç»œç»¼è¿°ï¼šæ¨¡å‹ä¸åº”ç”¨](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247493906&idx=1&sn=15c9f18a1ce6baa15dc85ecb52e799f6&chksm=96ea3692a19dbf847c1711e6e194ad60d80d11138daf0938f90489a054d77cfd523bee2dc1d2&scene=21#wechat_redirect)

- [DRr-Netï¼šåŸºäºåŠ¨æ€é‡è¯»æœºåˆ¶çš„å¥å­è¯­ä¹‰åŒ¹é…æ–¹æ³•](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247496112&idx=1&sn=923701d6be5204d2bf22f723df448531&chksm=96ea2e30a19da726e2475d38f8bdf2f9f891a388eb231bec4a343d3ed8f6052925643735cd68&scene=21#wechat_redirect)

- [å°æ ·æœ¬å­¦ä¹ ï¼ˆFew-shot Learningï¼‰ç»¼è¿°](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247496040&idx=1&sn=ebea875571ccc80a70a3166f62b9640b&chksm=96ea2ee8a19da7fe9bf3d9cbf15c3a2fc6e3ca898e48a2d01207a7cdc2cd046c4087eda27637&scene=21#wechat_redirect)

- [ä¸‡å­—ç»¼è¿°ä¹‹ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247495668&idx=1&sn=e7e959b2bdd7b2763b9207ccb80fa6bc&chksm=96ea3074a19db96208a51d26f7b5b4ef9c3a37a7799ec270becc77203de4294235041ede7206&scene=21#wechat_redirect)

- [å¯é€†ResNetï¼šæè‡´çš„æš´åŠ›ç¾å­¦](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247495880&idx=1&sn=e3a960836797c7dd4eb2dbb9b9a0b9e7&chksm=96ea2f48a19da65eea9cc157f2110a6856985d322d872c6679a8dd0807c9bb10f85c4d3c3f7d&scene=21#wechat_redirect)

- [åŸºäºå¤šä»»åŠ¡å­¦ä¹ çš„å¯è§£é‡Šæ¨èç³»ç»Ÿ](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247495957&idx=1&sn=2e614a271d9ba5c6391987c16455deff&chksm=96ea2e95a19da783b7470a9d66753644eab6a0fe0441e795a400f6c888a96692770e177ed1fb&scene=21#wechat_redirect)

- [AAAI 2019 | åŸºäºåˆ†å±‚å¼ºåŒ–å­¦ä¹ çš„å…³ç³»æŠ½å–](http://mp.weixin.qq.com/s?__biz=MzIwMTc4ODE0Mw==&mid=2247495926&idx=1&sn=a59ffa7b3639497e68617e1ea40d8cd2&chksm=96ea2f76a19da660508b0d149101cbc9591c3203622eea1545a26181f86a26404723101c9baf&scene=21#wechat_redirect)

  







**![img](https://mmbiz.qpic.cn/mmbiz_gif/xuKyIMVqtF2cO2WSmiccOqL8YlIwp5Xv2cqdDp6ANbUt8yibCc1cgQQrPHLKhf73icQGHves57M2XMZLJxIhF0e7g/640?tp=webp&wxfrom=5&wx_lazy=1)****#****æŠ• ç¨¿ é€š é“#**

 **è®©ä½ çš„è®ºæ–‡è¢«æ›´å¤šäººçœ‹åˆ°** 





å¦‚ä½•æ‰èƒ½è®©æ›´å¤šçš„ä¼˜è´¨å†…å®¹ä»¥æ›´çŸ­è·¯å¾„åˆ°è¾¾è¯»è€…ç¾¤ä½“ï¼Œç¼©çŸ­è¯»è€…å¯»æ‰¾ä¼˜è´¨å†…å®¹çš„æˆæœ¬å‘¢ï¼Ÿ**ç­”æ¡ˆå°±æ˜¯ï¼šä½ ä¸è®¤è¯†çš„äººã€‚**



æ€»æœ‰ä¸€äº›ä½ ä¸è®¤è¯†çš„äººï¼ŒçŸ¥é“ä½ æƒ³çŸ¥é“çš„ä¸œè¥¿ã€‚PaperWeekly æˆ–è®¸å¯ä»¥æˆä¸ºä¸€åº§æ¡¥æ¢ï¼Œä¿ƒä½¿ä¸åŒèƒŒæ™¯ã€ä¸åŒæ–¹å‘çš„å­¦è€…å’Œå­¦æœ¯çµæ„Ÿç›¸äº’ç¢°æ’ï¼Œè¿¸å‘å‡ºæ›´å¤šçš„å¯èƒ½æ€§ã€‚



PaperWeekly é¼“åŠ±é«˜æ ¡å®éªŒå®¤æˆ–ä¸ªäººï¼Œåœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šåˆ†äº«å„ç±»ä¼˜è´¨å†…å®¹ï¼Œå¯ä»¥æ˜¯**æœ€æ–°è®ºæ–‡è§£è¯»**ï¼Œä¹Ÿå¯ä»¥æ˜¯**å­¦ä¹ å¿ƒå¾—**æˆ–**æŠ€æœ¯å¹²è´§**ã€‚æˆ‘ä»¬çš„ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œè®©çŸ¥è¯†çœŸæ­£æµåŠ¨èµ·æ¥ã€‚



ğŸ“ **æ¥ç¨¿æ ‡å‡†ï¼š**

â€¢ ç¨¿ä»¶ç¡®ç³»ä¸ªäºº**åŸåˆ›ä½œå“**ï¼Œæ¥ç¨¿éœ€æ³¨æ˜ä½œè€…ä¸ªäººä¿¡æ¯ï¼ˆå§“å+å­¦æ ¡/å·¥ä½œå•ä½+å­¦å†/èŒä½+ç ”ç©¶æ–¹å‘ï¼‰ 

â€¢ å¦‚æœæ–‡ç« å¹¶éé¦–å‘ï¼Œè¯·åœ¨æŠ•ç¨¿æ—¶æé†’å¹¶é™„ä¸Šæ‰€æœ‰å·²å‘å¸ƒé“¾æ¥ 

â€¢ PaperWeekly é»˜è®¤æ¯ç¯‡æ–‡ç« éƒ½æ˜¯é¦–å‘ï¼Œå‡ä¼šæ·»åŠ â€œåŸåˆ›â€æ ‡å¿—



**ğŸ“¬ æŠ•ç¨¿é‚®ç®±ï¼š**

â€¢ æŠ•ç¨¿é‚®ç®±ï¼šhr@paperweekly.site 

â€¢ æ‰€æœ‰æ–‡ç« é…å›¾ï¼Œè¯·å•ç‹¬åœ¨é™„ä»¶ä¸­å‘é€ 

â€¢ è¯·ç•™ä¸‹å³æ—¶è”ç³»æ–¹å¼ï¼ˆå¾®ä¿¡æˆ–æ‰‹æœºï¼‰ï¼Œä»¥ä¾¿æˆ‘ä»¬åœ¨ç¼–è¾‘å‘å¸ƒæ—¶å’Œä½œè€…æ²Ÿé€š







ğŸ”



ç°åœ¨ï¼Œåœ¨**ã€ŒçŸ¥ä¹ã€**ä¹Ÿèƒ½æ‰¾åˆ°æˆ‘ä»¬äº†

è¿›å…¥çŸ¥ä¹é¦–é¡µæœç´¢**ã€ŒPaperWeeklyã€**

ç‚¹å‡»**ã€Œå…³æ³¨ã€**è®¢é˜…æˆ‘ä»¬çš„ä¸“æ å§





**å…³äºPaperWeekly**



PaperWeekly æ˜¯ä¸€ä¸ªæ¨èã€è§£è¯»ã€è®¨è®ºã€æŠ¥é“äººå·¥æ™ºèƒ½å‰æ²¿è®ºæ–‡æˆæœçš„å­¦æœ¯å¹³å°ã€‚å¦‚æœä½ ç ”ç©¶æˆ–ä»äº‹ AI é¢†åŸŸï¼Œæ¬¢è¿åœ¨å…¬ä¼—å·åå°ç‚¹å‡»**ã€Œäº¤æµç¾¤ã€**ï¼Œå°åŠ©æ‰‹å°†æŠŠä½ å¸¦å…¥ PaperWeekly çš„äº¤æµç¾¤é‡Œã€‚



![img](data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)

â–½ ç‚¹å‡» | é˜…è¯»åŸæ–‡ | è®¿é—®PARLå®˜ç½‘

é˜…è¯»åŸæ–‡

é˜…è¯» 4319

 åœ¨çœ‹32



[å†™ç•™è¨€](javascript:;)